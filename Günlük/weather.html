<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Hava Durumu - AnlıkGöz</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-image: url('https://source.unsplash.com/1600x900/?weather');
      background-size: cover;
      background-position: center;
    }
  </style>
</head>
<body class="bg-gray-100 font-sans">
<body class="bg-gray-100 font-sans">

  <section class="min-h-screen flex flex-col items-center justify-center bg-black bg-opacity-50 p-6">
    <h1 class="text-4xl font-bold mb-10 text-center">Hangi Şehire bakmak istersiniz?</h1>

    <!-- Şehir Seçim Bölümü -->
    <div class="text-center mb-6">
      <input id="city-input" type="text" placeholder="Şehir adı girin..." class="p-3 rounded-lg shadow-md border-2 w-full max-w-xs">
      <button id="search-btn" class="mt-4 p-3 bg-blue-500 text-white rounded-lg shadow-lg">Hava Durumunu Göster</button>
    </div>

    <!-- Günün Hava Durumu -->
    <div id="weather-info" class="mb-6">
      <p class="text-lg">Hava durumu verisi yükleniyor...</p>
    </div>

    <!-- 5 Günlük Hava Durumu -->
    <div id="forecast-info" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-6 w-full max-w-6xl">
      <!-- Dinamik olarak 5 gün hava durumu kartları eklenecek -->
    </div>

    <!-- Geri Dönüş Butonu -->
    <div class="absolute bottom-10 left-10">
      <a href="index.html" class="bg-green-500 text-white p-3 rounded-full shadow-lg hover:bg-green-700 transition duration-300">Geri Dön</a>
    </div>
  </section>

  <script>
    const apiKey = '40b144780f7931e8e43a16466546b7ce';

    // Hava Durumu API
    document.getElementById('search-btn').addEventListener('click', function() {
      const city = document.getElementById('city-input').value.trim();

      if (city === '') {
        alert('Lütfen bir şehir girin!');
        return;
      }

      // Günlük hava durumu için API
      fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=tr`)
        .then(res => res.json())
        .then(data => {
          if (data.cod === '404') {
            document.getElementById('weather-info').innerHTML = "<p>Şehir bulunamadı.</p>";
            return;
          }

          const weatherDescription = data.weather[0].description;
          let weatherIcon = '';
          let backgroundImage = '';

          // Hava durumu türüne göre ikon ve arka plan seçimi
          switch (weatherDescription) {
            case 'clear sky':
              weatherIcon = '🌞';  // Güneşli
              backgroundImage = 'https://source.unsplash.com/1600x900/?sunny';
              break;
            case 'few clouds':
            case 'scattered clouds':
              weatherIcon = '☁️';  // Az bulutlu
              backgroundImage = 'https://source.unsplash.com/1600x900/?cloudy';
              break;
            case 'broken clouds':
              weatherIcon = '☁️';  // Bulutlu
              backgroundImage = 'https://source.unsplash.com/1600x900/?cloudy';
              break;
            case 'shower rain':
            case 'rain':
              weatherIcon = '🌧️';  // Yağmurlu
              backgroundImage = 'https://source.unsplash.com/1600x900/?rainy';
              break;
            case 'thunderstorm':
              weatherIcon = '⛈️';  // Fırtına
              backgroundImage = 'https://source.unsplash.com/1600x900/?storm';
              break;
            case 'snow':
              weatherIcon = '❄️';  // Kar
              backgroundImage = 'https://source.unsplash.com/1600x900/?snow';
              break;
            default:
              weatherIcon = '🌥️';  // Diğer hava durumu
              backgroundImage = 'https://source.unsplash.com/1600x900/?weather';
              break;
          }

          // Arka planı değiştir
          document.body.style.backgroundImage = `url(${backgroundImage})`;

          document.getElementById('weather-info').innerHTML = `
            <h2 class="text-2xl font-semibold">${city} ${weatherIcon}</h2>
            <p class="text-xl">${data.main.temp}°C, ${weatherDescription}</p>
            <p class="text-lg">Nem: ${data.main.humidity}%</p>
            <p class="text-lg">Rüzgar Hızı: ${data.wind.speed} m/s</p>
          `;
        })
        .catch(() => document.getElementById('weather-info').innerHTML = "<p>Veri alınamadı.</p>");

      // 5 Günlük Hava Durumu için API
      fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${apiKey}&units=metric&lang=tr`)
        .then(res => res.json())
        .then(data => {
          let forecastHTML = '';
          let days = new Set();  // Aynı günü tekrar etmemek için bir Set kullanıyoruz
          data.list.forEach(item => {
            const date = new Date(item.dt * 1000);
            const day = date.toLocaleDateString('tr-TR', { weekday: 'long' });

            // Aynı gün birden fazla görmemek için kontrol
            if (!days.has(day)) {
              days.add(day);
              forecastHTML += `
                <div class="bg-blue-300 p-6 rounded-xl shadow-md text-center">
                  <h3 class="font-semibold">${day}</h3>
                  <p class="text-lg">${item.main.temp}°C</p>
                  <p class="text-sm">${item.weather[0].description}</p>
                </div>
              `;
            }
          });

          document.getElementById('forecast-info').innerHTML = forecastHTML;
        })
        .catch(() => document.getElementById('forecast-info').innerHTML = "<p>Veri alınamadı.</p>");
    });
  </script>

</body>
</html>
